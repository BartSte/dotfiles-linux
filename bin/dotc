#!/bin/bash
# Mass commit to all dotfiles layers.
# All command line args are concatinated into a commit message

#######################################
# Remove (use -u to show untracked-files) 
# from the sdout
#######################################
shorten_stdout(){
    sed 's/(use -u .*)//'
}
message="'$*'"
common_args="--work-tree=$HOME commit --untracked-files=no -a"

echo 'Base:'
git --git-dir=$HOME/dotfiles.git/ $common_args -m "$message" | shorten_stdout

echo $'\nLinux'
git --git-dir=$HOME/dotfiles-linux.git/ $common_args -m "$message" | shorten_stdout

echo $'\nSecret'
git --git-dir=$HOME/dotfiles-secret.git/ $common_args -m "$message" | shorten_stdout
