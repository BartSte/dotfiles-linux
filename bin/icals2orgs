#!/usr/bin/env python
"""
PoC for converting multiple ics files in to org files with the same base name as
its ics conterpart. These org files are placed in a directory which should be
the last cli arg. Examples:
```
icalc2orgs /path/to/*.ics /path/to/directory/
```
"""
from os.path import basename, join, splitext
import sys

from os import remove
from ical2orgpy import Convertor

if __name__ == '__main__':
    ics_files: list = sys.argv[1:-1]
    directory: str = sys.argv[-1]
    convertor = Convertor()

    for ics in ics_files:
        name, _ = splitext(basename(ics))
        org: str = join(directory, name + '.org')

        print(f'Convert: {ics} to {org}')

        with open(ics, 'r', encoding="utf-8") as source:
            with open(org, 'a', encoding="utf-8") as destination:
                convertor(source, destination)
